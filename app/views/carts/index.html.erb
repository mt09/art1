<div class="row">
	<div class="col-md-12">
		<h2>購物車</h2>

		<% if current_cart.cart_items.count > 0 %>
			<div class="pull-right" style="text-decoration=underline; padding-bottom:10px;">
				<%= link_to "清空購物車", clean_carts_path, method: :delete, data: {confirm: "Sure?"} %>
			</div>
		<% else %>
			<p class="pull-right" style="padding-bottom:10px; font-size:20px;">購物車尚無商品</p>
		<% end %>

		<table class="table table-bordered">
			<thead>
				<tr>
					<th colspan="2">商品</th>
					<th>單價</th>
					<th>數量</th>
					<th>操作選項</th>
				</tr>
			</thead>
			<tbody>
				<% current_cart.items.each do |product| %>
					<tr>
						<td>
							<%= link_to product_path(product) do %>
								<% if product.photo.present? %>
									<%= image_tag(product.photo.image.medium.url, class: "thumbnail") %>
								<% else %>
									<%= image_tag("https://placehold.it/200x200&text=No Pic", class: "thumbnail") %>
								<% end %>
							<% end %>
						</td>
						<td><%= link_to product.title, product_path(product) %></td>
						<td><%= product.price %></td>
						<td>
							<% item = current_cart.find_cart_item(product) %>

							<%= form_for item, url: item_path(product) do |f| %>
								<%= f.select :quantity, 1..product.quantity %>
								<%= f.submit "Update", data: { disable_with: "Submiting..." } %>
							<% end %>
 						</td>
						<td>
							<%= link_to item_path(product), method: :delete do %>
								<i class="fa fa-trash"></i>
							<% end %>
						</td>
					</tr>
				<% end %>
				<tr>
				</tr>
			</tbody>
		</table>

		<div class="total clearfix">
			<span class="pull-right">總計 <%= render_cart_total_price(current_cart) %> 元</span>
		</div>

		<br>

		<div class="pull-right">
			<% if current_cart.total_price > 0 %>
				<%= link_to "Checkout", checkout_carts_path, method: :post, class: "btn btn-danger btn-lg" %>
			<% else %>
				<%= link_to "回到上頁參觀商品", root_path, class: "btn btn-danger btn-lg" %>
			<% end %>
		</div>
	</div>
</div>